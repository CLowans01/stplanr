<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Convert origin-destination data to spatial lines — od2line • stplanr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>



<!-- Bootstrap -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>

<!-- ropensci -->
<link href="../ropensci.css" rel="stylesheet">

<meta property="og:title" content="Convert origin-destination data to spatial lines — od2line" />
<meta property="og:description" content="Origin-destination ('OD') flow data is often provided
in the form of 1 line per flow with zone codes of origin and destination
centroids. This can be tricky to plot and link-up with geographical data.
This function makes the task easier." />
<meta name="twitter:card" content="summary" />






<!-- Matomo -->
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script>
<script src="https://ropensci.org/scripts/matomo.js"></script>
<noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt="" /></p></noscript>

<!-- End Matomo Code -->

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://ropensci.org"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci" /></a>
        <a class="navbar-brand" href="../index.html"><i>stplanr <small>v0.8.0.9000</small></i></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/stplanr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/stplanr-od.html">Origin-destination data with stplanr</a>
    </li>
    <li>
      <a href="../articles/stplanr-paper.html">stplanr: A Package for Transport Planning</a>
    </li>
    <li>
      <a href="../articles/stplanr-parallel.html">Parallel routing and performance with stplanr</a>
    </li>
    <li>
      <a href="../articles/stplanr-route-nets.html">Route networks with stplanr</a>
    </li>
    <li>
      <a href="../articles/stplanr-routing.html">Transport routing with stplanr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ropensci/stplanr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Convert origin-destination data to spatial lines</h1>
    <small class="dont-index">Source: <a href='https://github.com/ropensci/stplanr/blob/master/R/od-funs.R'><code>R/od-funs.R</code></a></small>
    <div class="hidden name"><code>od2line.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Origin-destination ('OD') flow data is often provided
in the form of 1 line per flow with zone codes of origin and destination
centroids. This can be tricky to plot and link-up with geographical data.
This function makes the task easier.</p>
    </div>

    <pre class="usage"><span class='fu'>od2line</span><span class='op'>(</span>
  <span class='va'>flow</span>,
  <span class='va'>zones</span>,
  destinations <span class='op'>=</span> <span class='cn'>NULL</span>,
  zone_code <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>zones</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  origin_code <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>flow</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  dest_code <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>flow</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>,
  zone_code_d <span class='op'>=</span> <span class='cn'>NA</span>,
  silent <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='fu'>od2line2</span><span class='op'>(</span><span class='va'>flow</span>, <span class='va'>zones</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>flow</th>
      <td><p>A data frame representing origin-destination data.
The first two columns of this data frame should correspond
to the first column of the data in the zones. Thus in <code><a href='cents.html'>cents()</a></code>,
the first column is geo_code. This corresponds to the first two columns
of <code><a href='flow.html'>flow()</a></code>.</p></td>
    </tr>
    <tr>
      <th>zones</th>
      <td><p>A spatial object representing origins (and destinations
if no separate destinations object is provided) of travel.</p></td>
    </tr>
    <tr>
      <th>destinations</th>
      <td><p>A spatial object
representing destinations of travel flows.</p></td>
    </tr>
    <tr>
      <th>zone_code</th>
      <td><p>Name of the variable in <code>zones</code> containing the ids of the zone.
By default this is the first column names in the zones.</p></td>
    </tr>
    <tr>
      <th>origin_code</th>
      <td><p>Name of the variable in <code>flow</code> containing the ids of the zone of origin.
By default this is the first column name in the flow input dataset.</p></td>
    </tr>
    <tr>
      <th>dest_code</th>
      <td><p>Name of the variable in <code>flow</code> containing the ids of the zone of destination.
By default this is the second column name in the flow input dataset or the first column name in the
destinations if that is set.</p></td>
    </tr>
    <tr>
      <th>zone_code_d</th>
      <td><p>Name of the variable in <code>destinations</code> containing the ids of the zone.
By default this is the first column names in the destinations.</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>TRUE by default, setting it to TRUE will show you the matching columns</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Origin-destination (OD) data is often provided
in the form of 1 line per OD pair, with zone codes of the trip origin in the first
column and the zone codes of the destination in the second column
(see the <a href='https://docs.ropensci.org/stplanr/articles/stplanr-od.html'><code><a href='../articles/stplanr-od.html'>vignette("stplanr-od")</a></code></a>) for details.
<code>od2line()</code> creates a spatial (linestring) object representing movement from the origin
to the destination for each OD pair.
It takes data frame containing
origin and destination cones (<code>flow</code>) that match the first column in a
a spatial (polygon or point) object (<code>zones</code>).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other od: 
<code><a href='dist_google.html'>dist_google</a>()</code>,
<code><a href='od2odf.html'>od2odf</a>()</code>,
<code><a href='od_aggregate_from.html'>od_aggregate_from</a>()</code>,
<code><a href='od_aggregate_to.html'>od_aggregate_to</a>()</code>,
<code><a href='od_coords2line.html'>od_coords2line</a>()</code>,
<code><a href='od_coords.html'>od_coords</a>()</code>,
<code><a href='od_dist.html'>od_dist</a>()</code>,
<code><a href='od_id.html'>od_id</a></code>,
<code><a href='od_oneway.html'>od_oneway</a>()</code>,
<code><a href='od_to_odmatrix.html'>od_to_odmatrix</a>()</code>,
<code><a href='odmatrix_to_od.html'>odmatrix_to_od</a>()</code>,
<code><a href='points2flow.html'>points2flow</a>()</code>,
<code><a href='points2odf.html'>points2odf</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>od_data</span> <span class='op'>&lt;-</span> <span class='fu'>stplanr</span><span class='fu'>::</span><span class='va'><a href='flow.html'>flow</a></span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span>, <span class='op'>]</span>
<span class='va'>l</span> <span class='op'>&lt;-</span> <span class='fu'>od2line</span><span class='op'>(</span>flow <span class='op'>=</span> <span class='va'>od_data</span>, zones <span class='op'>=</span> <span class='va'>cents_sf</span><span class='op'>)</span>
<span class='fu'><a href='https://r-spatial.github.io/sf/reference/plot.html'>plot</a></span><span class='op'>(</span><span class='fu'>sf</span><span class='fu'>::</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_geometry.html'>st_geometry</a></span><span class='op'>(</span><span class='va'>cents_sf</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://r-spatial.github.io/sf/reference/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>l</span>, lwd <span class='op'>=</span> <span class='va'>l</span><span class='op'>$</span><span class='va'>All</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>l</span><span class='op'>$</span><span class='va'>All</span><span class='op'>)</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: ignoring all but the first attribute</span></div><div class='img'><img src='od2line-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>l</span> <span class='op'>&lt;-</span> <span class='fu'>od2line</span><span class='op'>(</span>flow <span class='op'>=</span> <span class='va'>od_data</span>, zones <span class='op'>=</span> <span class='va'>cents</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum Unknown based on WGS84 ellipsoid in CRS definition</span></div><div class='input'><span class='co'># When destinations are different</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>destinations</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; class       : SpatialPointsDataFrame 
#&gt; features    : 6 
#&gt; extent      : -1.540901, -1.492713, 53.80131, 53.81724  (xmin, xmax, ymin, ymax)
#&gt; crs         : +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs 
#&gt; variables   : 5
#&gt; names       :    WZ11CD,   LAD11CD, COWZEW_SG,                     COWZEW_SGN, COWZEW_G 
#&gt; min values  : E33010351, E08000035,         2, Manufacturing and distribution,       2c 
#&gt; max values  : E33012352, E08000035,         7,                       Top jobs,       7c </div><div class='input'><span class='va'>od_data2</span> <span class='op'>&lt;-</span> <span class='va'>flow_dests</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>12</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>
<span class='va'>od_data2</span>
</div><div class='output co'>#&gt;        Area.of.residence    WZ11CD All
#&gt; 920573         E02002361 E33010350 109
#&gt; 920575         E02002361 E33010390  38
#&gt; 920578         E02002361 E33010468  10
#&gt; 920582         E02002361 E33012367  44
#&gt; 920587         E02002361 E33012225  34
#&gt; 920591         E02002361 E33012368   7
#&gt; 920601         E02002361 E33012333  94
#&gt; 921220         E02002363 E33012414  30
#&gt; 921222         E02002363 E33012313 183
#&gt; 921225         E02002363 E33010464  11
#&gt; 921228         E02002363 E33012254  72
#&gt; 921233         E02002363 E33012352  13</div><div class='input'><span class='va'>flowlines_dests</span> <span class='op'>&lt;-</span> <span class='fu'>od2line</span><span class='op'>(</span><span class='va'>od_data2</span>, <span class='va'>cents_sf</span>, destinations <span class='op'>=</span> <span class='va'>destinations_sf</span><span class='op'>)</span>
<span class='va'>flowlines_dests</span>
</div><div class='output co'>#&gt; Simple feature collection with 12 features and 3 fields
#&gt; geometry type:  LINESTRING
#&gt; dimension:      XY
#&gt; bbox:           xmin: -1.563202 ymin: 53.79647 xmax: -1.492713 ymax: 53.83587
#&gt; geographic CRS: WGS 84
#&gt; First 10 features:
#&gt;    Area.of.residence    WZ11CD All                       geometry
#&gt; 1          E02002361 E33010350 109 LINESTRING (-1.516734 53.82...
#&gt; 2          E02002361 E33010390  38 LINESTRING (-1.516734 53.82...
#&gt; 3          E02002361 E33010468  10 LINESTRING (-1.516734 53.82...
#&gt; 4          E02002361 E33012367  44 LINESTRING (-1.516734 53.82...
#&gt; 5          E02002361 E33012225  34 LINESTRING (-1.516734 53.82...
#&gt; 6          E02002361 E33012368   7 LINESTRING (-1.516734 53.82...
#&gt; 7          E02002361 E33012333  94 LINESTRING (-1.516734 53.82...
#&gt; 8          E02002363 E33012414  30 LINESTRING (-1.535617 53.82...
#&gt; 9          E02002363 E33012313 183 LINESTRING (-1.535617 53.82...
#&gt; 10         E02002363 E33010464  11 LINESTRING (-1.535617 53.82...</div><div class='input'><span class='fu'><a href='https://r-spatial.github.io/sf/reference/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>flowlines_dests</span><span class='op'>)</span>
</div><div class='img'><img src='od2line-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <!-- begin footer -->
<div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg" /></div>
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="http://github.com/ropensci" target="_blank"><div class="icon fab fa-github"></div></a>
                        <a href="http://github.com/ropenscilabs" target="_blank"><div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/ropensci" target="_blank"><div class="icon fab fa-twitter"></div></a>
                        <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
                            <h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review">Software Review Process</a></li>
                            <li><a href="https://ropensci.org/about#team">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate">Donate</a></li>
                            <li><a href="https://ropensci.org/contact">Contact Us</a></li>
                        </ul>
                    </div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
                            <h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct">Code of conduct</a></li>
                        </ul>
                    </div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
                            <h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/">Talks & Publications</a></li>
                            <li><a href="https://docs.ropensci.org/">Documentation</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/">Cite rOpenSci</a></li>
                        </ul>
                    </div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                        <a href="http://numfocus.org" target="_blank"></a>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

      </footer>
   </div>

  


  </body>
</html>


